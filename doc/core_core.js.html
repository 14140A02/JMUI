<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: core/core.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: core/core.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Copyright (c) 2014 Tencent AlloyTeam, All rights reserved.
 * http://www.AlloyTeam.com/
 * Code licensed under the BSD License:
 * http://www.AlloyTeam.com/license.txt
 * 
 * @author  Yussicahe
 * @description JMUI核心js
 */

;(function ($) {
	var DATA_PREFIX = 'jmu';		// data存储前缀

	/**
	 * @function attributeData 
	 * @description 从DOM节点上获取所有"data-*"属性
	 * @param object DOM节点
	 * @returns {object} "data-*"属性的键值对
	 */
	function attributeData(node) {
		var store = {};

		$.each(node.attributes || [], function (i, attr) {
		  	if (parseInt(attr.name.indexOf('data-'), 10) === 0) {
		    	store[$.camelCase(attr.name.replace('data-', ''))] = $.zepto.deserializeValue(attr.value);
		    }
		});

		return store;
	}

	/**
	 * @function zeptolize 
	 * @description 将组件挂到$.fn上，便于调用
	 * @param {string} 组件名
	 */
	function zeptolize(name) {
	    var key = $.camelCase(name.substring(0, 1).toLowerCase() + name.substring(1)),
	        old = $.fn[key];

        /**
         * @function 
         * @description 调用组件
         * @param {object} 组件配置选项
         * @param {string} 组件方法名
         * @returns {*} 组件实例或者相应方法的返回值
         */
	    $.fn[key] = function (options, func) {
	        var args,
	            ret,
	            component,
	            dataName = DATA_PREFIX + '-' + name;

	        if (typeof options === 'string') {
                args = [].slice.call(arguments, 1);
	        	func = options;
	        } else {
                args = [].slice.call(arguments, 2);
            }

	        $.each(this, function (i, el) {
	            // 尝试从data中取组件实例
	            component = $(el).data(dataName);

	            if (typeof component === 'undefined') {
                    var attrOptions = attributeData(el);

	            	component = new JMU[name](el, $.extend({}, options, attrOptions));    // 无实例则创建一个

	            	$(el).data(dataName, component);
	            } else if (options) {    // 更新组件的配置选项
	            	component.setOptions(options);
	            }

	            if (typeof func === 'undefined') {    // 未指定方法，返回组件实例
	                ret = component;

	                return false;    // 断开循环
	            } else {    // 调用组件指定方法
                    func = component[func];

	                // 如果组件无指定方法，抛出错误信息
	                if (!$.isFunction(func)) {
	                    throw new Error(name + ' has no such method "' + func + '".');
	                }

	                ret = func.apply(component, args);

	                // 如果是get性质的方法，断开循环
	                if (typeof ret !== 'undefined') {
	                    return false;
	                }
	            }
	        });

	        return typeof ret !== 'undefined'? ret : this;
	    };

	    // NO CONFLICT
	    $.fn[key].noConflict = function () {
	        $.fn[key] = old;
	        return this;
	    };
	}

    window.JMU = {
        /**
         * @function emptyFunction
         * @description 空函数
         */
        emptyFunction: function () {},
        /**
         * @function preventDefault
         * @description 阻止事件的默认行为
         * @param {object} 事件对象e
         */
        preventDefault: function (e) {
            e = e || window.event;
            e.preventDefault();
        },
    	/**
         * @function defineComponent
         * @description 定义组件
         * @param {string} 组件名
         * @param {object} 组件原型
         * @param {class} 组件的父类
         * @returns {class} 组件类
         */
	    defineComponent: function (name, object, superClass) {
	        if (!$.isFunction(superClass)) {
	            superClass = JMU.Component;    // 默认基类为Component
	        }

            /**
             * @class
             * @description 组件类
             * @param object 组件的容器节点
             * @param {object} 组件配置选项
             */
	        function subClass(container, options) {
                // 设置组件配置选项
                this.setOptions(options);

                // 初始化组件
	            this._init(container);
	        }

	        subClass.superClass = superClass;
	        subClass.prototype = Object.create(superClass.prototype);

            /**
             * @function $super
             * @description 调用父类的方法
             * @param {string} 方法名
             * @returns {*} 方法的返回值
             */ 
	        object.$super = function (name) {
	            var func = superClass.prototype[name];
	            return $.isFunction(func) &amp;&amp; func.apply(this, arguments.slice(1));
	        };

	        $.extend(subClass.prototype, object);

        	JMU[name] = subClass;
        	zeptolize(name);

	        return subClass;
	    }
    };
})(Zepto);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="window.JMU.defineComponent-subClass.html">subClass</a></li></ul><h3>Global</h3><ul><li><a href="global.html#$super">$super</a></li><li><a href="global.html#_init">_init</a></li><li><a href="global.html#attributeData">attributeData</a></li><li><a href="global.html#defineComponent">defineComponent</a></li><li><a href="global.html#emptyFunction">emptyFunction</a></li><li><a href="global.html#preventDefault">preventDefault</a></li><li><a href="global.html#slider">slider</a></li><li><a href="global.html#zeptolize">zeptolize</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha13</a> on Thu Jan 22 2015 13:55:37 GMT+0800 (中国标准时间)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
